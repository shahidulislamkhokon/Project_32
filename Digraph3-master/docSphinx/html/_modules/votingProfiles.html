
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>votingProfiles &#8212; Digraph3 3.7-3200+ documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Digraph3 3.7-3200+ documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for votingProfiles</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Python 3 implementation of voting digraphs</span>
<span class="sd">Refactored from revision 1.549 of the digraphs module</span>
<span class="sd">Copyright (C) 2011-2020 Raymond Bisdorff</span>

<span class="sd">    This program is free software; you can redistribute it and/or modify</span>
<span class="sd">    it under the terms of the GNU General Public License as published by</span>
<span class="sd">    the Free Software Foundation; either version 3 of the License, or</span>
<span class="sd">    (at your option) any later version.</span>

<span class="sd">    This program is distributed in the hope that it will be useful,</span>
<span class="sd">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="sd">    GNU General Public License for more details.</span>

<span class="sd">    You should have received a copy of the GNU General Public License along</span>
<span class="sd">    with this program; if not, write to the Free Software Foundation, Inc.,</span>
<span class="sd">    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#######################</span>
<span class="kn">from</span> <span class="nn">digraphsTools</span> <span class="kn">import</span> <span class="o">*</span> 
<span class="kn">from</span> <span class="nn">digraphs</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1">#--------- Decimal precision --------------</span>
<span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>

<span class="c1">#---------- voting profiles</span>

<div class="viewcode-block" id="VotingProfile"><a class="viewcode-back" href="../techDoc.html#votingProfiles.VotingProfile">[docs]</a><span class="k">class</span> <span class="nc">VotingProfile</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A generic class for storing voting profiles.</span>

<span class="sd">    General structure::</span>

<span class="sd">	candidates = OrderedDict([(&#39;a&#39;, ...),(&#39;b&#39;, ...),(&#39;c&#39;, ...), ( ... ) ])</span>
<span class="sd">	voters = OrderedDict([</span>
<span class="sd">        (&#39;1&#39;, {&#39;weight&#39;:1.0}),</span>
<span class="sd">        (&#39;2&#39;, {&#39;weight&#39;:1.0}),</span>
<span class="sd">        ...,</span>
<span class="sd">        ])</span>
<span class="sd">    	ballot = {     # voters x candidates x candidates</span>
<span class="sd">            &#39;1&#39;: {     # bipolar characteristic {-1,0,1} of each voter&#39;s</span>
<span class="sd">                  &#39;a&#39;: { &#39;a&#39;:0,&#39;b&#39;:-1,&#39;c&#39;:0, ...},   # pairwise preferences</span>
<span class="sd">                  &#39;b&#39;: { &#39;a&#39;:1,&#39;b&#39;:0, &#39;c&#39;:1, ...},</span>
<span class="sd">    	          &#39;c&#39;: { &#39;a&#39;:0,&#39;b&#39;:-1,&#39;c&#39;:0, ...},</span>
<span class="sd">    	          ...,</span>
<span class="sd">    	    },</span>
<span class="sd">    	    &#39;2&#39;: { &#39;a&#39;: { &#39;a&#39;:0, &#39;b&#39;:0, &#39;c&#39;:1, ...},</span>
<span class="sd">                   &#39;b&#39;: { &#39;a&#39;:0, &#39;b&#39;:0, &#39;c&#39;:1, ...},</span>
<span class="sd">    	           &#39;c&#39;: { &#39;a&#39;:-1,&#39;b&#39;:-1,&#39;c&#39;:0, ...},</span>
<span class="sd">    	           ...,</span>
<span class="sd">            },</span>
<span class="sd">    	    ...,</span>
<span class="sd">    	}</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Default description for VotingProfile instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reprString</span> <span class="o">=</span> <span class="s1">&#39;*------- VotingProfile instance description ------*</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Instance class   : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Instance name    : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;# Candidates     : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">)</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;# Voters         : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">)</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Attributes       : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
       
        <span class="k">return</span> <span class="n">reprString</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileVotingProfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">fileVotingProfile</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">fileVotingProfile</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
            <span class="n">argDict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">exec</span><span class="p">(</span><span class="nb">compile</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">fileName</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">),</span><span class="n">argDict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileVotingProfile</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;candidates&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">voters</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;voters&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;ballot&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">randv</span> <span class="o">=</span> <span class="n">RandomVotingProfile</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;randomCondorcet&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="n">randv</span><span class="o">.</span><span class="n">candidates</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">voters</span> <span class="o">=</span> <span class="n">randv</span><span class="o">.</span><span class="n">voters</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="n">randv</span><span class="o">.</span><span class="n">ballot</span>

<div class="viewcode-block" id="VotingProfile.showAll"><a class="viewcode-back" href="../techDoc.html#votingProfiles.VotingProfile.showAll">[docs]</a>    <span class="k">def</span> <span class="nf">showAll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">WithBallots</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show method for &lt;VotingProfile&gt; instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*------ VotingProfile instance: </span><span class="si">%s</span><span class="s1"> ------*&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">]</span>
        <span class="n">voters</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Voters     : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">voters</span><span class="p">))</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="n">candidates</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Candidates : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">candidates</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">WithBallots</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ballots&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;voting of voter </span><span class="si">%s</span><span class="s1"> (weight = </span><span class="si">%.1f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">showVoterBallot</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="VotingProfile.showVoterBallot"><a class="viewcode-back" href="../techDoc.html#votingProfiles.VotingProfile.showVoterBallot">[docs]</a>    <span class="k">def</span> <span class="nf">showVoterBallot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">voter</span><span class="p">,</span> <span class="n">hasIntegerValuation</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show the actual voting of a voter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  &gt;  |&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="s2">&quot;&#39;, &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-----|------------------------------------------------------------&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="s2">&quot;&#39; | &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">hasIntegerValuation</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ballot</span><span class="p">[</span><span class="n">voter</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ballot</span><span class="p">[</span><span class="n">voter</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="VotingProfile.save"><a class="viewcode-back" href="../techDoc.html#votingProfiles.VotingProfile.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;tempVprofile&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Persistant storage of an approval voting profile.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*--- Saving voting profile in file: &lt;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.py&gt; ---*&#39;</span><span class="p">)</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
        <span class="n">ballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span>
        <span class="n">saveFileName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.py&#39;</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">saveFileName</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Saved voting profile: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from collections import OrderedDict </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;candidates = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">candidateName</span> <span class="o">=</span> <span class="n">candidates</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">candidateName</span> <span class="o">=</span> <span class="n">x</span>
            <span class="c1">#fo.write(&#39;\&#39;&#39; + str(x) + &#39;\&#39;: {\&#39;name\&#39;: \&#39;&#39; + candidateName + &#39;\&#39;},\n&#39;)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\&#39;</span><span class="s1">name</span><span class="se">\&#39;</span><span class="s1">, </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">}),</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">candidateName</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;voters = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">weight</span><span class="se">\&#39;</span><span class="s1">:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;}),</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;ballot = {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ballot</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">: {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">:{&#39;</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">:&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;},</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;},</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div></div>

<div class="viewcode-block" id="LinearVotingProfile"><a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile">[docs]</a><span class="k">class</span> <span class="nc">LinearVotingProfile</span><span class="p">(</span><span class="n">VotingProfile</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A specialised class for linear voting profiles</span>

<span class="sd">    Structure::</span>

<span class="sd">        candidates = OrderedDict([(&#39;a&#39;, ...) ,(&#39;b&#39;, ...),(&#39;c&#39;, ...), ...])</span>
<span class="sd">        voters = OrderedDict([(&#39;1&#39;,{&#39;weight&#39;:1.0}), (&#39;2&#39;,{&#39;weight&#39;:1.0}), ...])</span>
<span class="sd">        ## each specifies a a ranked list of candidates</span>
<span class="sd">        ## from the best to the worst</span>
<span class="sd">        linearBallot = {</span>
<span class="sd">            &#39;1&#39; : [&#39;b&#39;,&#39;c&#39;,&#39;a&#39;, ...],</span>
<span class="sd">            &#39;2&#39; : [&#39;a&#39;,&#39;b&#39;,&#39;c&#39;, ...],</span>
<span class="sd">            ...</span>
<span class="sd">            }</span>

<span class="sd">    Sample Python3 session</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; from votingDigraphs import *</span>
<span class="sd">    &gt;&gt;&gt; v = RandomLinearVotingProfile(numberOfVoters=5,numberOfCandidates=3)</span>
<span class="sd">    &gt;&gt;&gt; v.showLinearBallots()</span>
<span class="sd">    voters(weight)	 candidates rankings</span>
<span class="sd">    v4(1.0): 	 [&#39;a1&#39;, &#39;a2&#39;, &#39;a3&#39;]</span>
<span class="sd">    v5(1.0): 	 [&#39;a1&#39;, &#39;a2&#39;, &#39;a3&#39;]</span>
<span class="sd">    v1(1.0): 	 [&#39;a2&#39;, &#39;a1&#39;, &#39;a3&#39;]</span>
<span class="sd">    v2(1.0): 	 [&#39;a1&#39;, &#39;a2&#39;, &#39;a3&#39;]</span>
<span class="sd">    v3(1.0): 	 [&#39;a1&#39;, &#39;a3&#39;, &#39;a2&#39;]</span>
<span class="sd">    &gt;&gt;&gt; v.computeRankAnalysis()</span>
<span class="sd">    {&#39;a1&#39;: [4.0, 1.0, 0],</span>
<span class="sd">     &#39;a2&#39;: [1.0, 3.0, 1.0],</span>
<span class="sd">     &#39;a3&#39;: [0, 1.0, 4.0]}</span>
<span class="sd">    &gt;&gt;&gt; v.showRankAnalysisTable()</span>
<span class="sd">    *----  Rank analysis tableau -----*</span>
<span class="sd">      ranks |  1    2    3    | Borda score</span>
<span class="sd">     -------|------------------------------</span>
<span class="sd">       &#39;a1&#39; |  4    1    0    |   6</span>
<span class="sd">       &#39;a2&#39; |  1    3    1    |   10</span>
<span class="sd">       &#39;a3&#39; |  0    1    4    |   14</span>
<span class="sd">    &gt;&gt;&gt; v.computeUninominalVotes()</span>
<span class="sd">    {&#39;a1&#39;: 4.0, &#39;a3&#39;: 0, &#39;a2&#39;: 1.0}</span>
<span class="sd">    &gt;&gt;&gt; v.computeSimpleMajorityWinner()</span>
<span class="sd">    [&#39;a1&#39;]</span>
<span class="sd">    &gt;&gt;&gt; v.computeBordaScores()</span>
<span class="sd">    {&#39;a1&#39;: 6.0, &#39;a3&#39;: 14.0, &#39;a2&#39;: 10.0}</span>
<span class="sd">    &gt;&gt;&gt; v.computeBordaWinners()</span>
<span class="sd">    [&#39;a1&#39;]</span>
<span class="sd">    &gt;&gt;&gt; v.computeInstantRunoffWinner()</span>
<span class="sd">    [&#39;a1&#39;]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileVotingProfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">numberOfCandidates</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                 <span class="n">numberOfVoters</span><span class="o">=</span><span class="mi">9</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">fileVotingProfile</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">fileVotingProfile</span> <span class="o">+</span> <span class="s1">&#39;.py&#39;</span>
        <span class="c1">## else:</span>
        <span class="c1">##     fileName = &#39;testapprovalvotingprofile.py&#39;</span>
            <span class="n">argDict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">exec</span><span class="p">(</span><span class="nb">compile</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">fileName</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">),</span><span class="n">argDict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileVotingProfile</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;candidates&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">voters</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;voters&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;linearBallot&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeBallot</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;!!! Error: The name of a stored linear voting profile is required !!!&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sumWeights</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sumWeights</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="LinearVotingProfile.computeBallot"><a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.computeBallot">[docs]</a>    <span class="k">def</span> <span class="nf">computeBallot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes a complete ballot from the linear Ballot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="n">linearBallot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span>
        <span class="n">ballot</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">linearBallot</span><span class="p">:</span>
            <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                    <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;0.0&quot;</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;1.0&quot;</span><span class="p">)</span>
                    <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;-1.0&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="n">ballot</span>
        <span class="k">return</span> <span class="n">ballot</span></div>

<div class="viewcode-block" id="LinearVotingProfile.save"><a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;templinearprofile&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Persistant storage of a linear voting profile.</span>

<span class="sd">        Parameter:</span>
<span class="sd">            name of file (without &lt;.py&gt; extension!).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*--- Saving linear profile in file: &lt;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.py&gt; ---*&#39;</span><span class="p">)</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
        <span class="n">linearBallot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span>
        <span class="n">saveFileName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.py&#39;</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">saveFileName</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Saved linear voting profile: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from collections import OrderedDict </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;candidates = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">candidateName</span> <span class="o">=</span> <span class="n">candidates</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">candidateName</span> <span class="o">=</span> <span class="n">x</span>
            <span class="c1">#fo.write(&#39;\&#39;&#39; + str(x) + &#39;\&#39;: {\&#39;name\&#39;: \&#39;&#39; + str(x)+ &#39;\&#39;},\n&#39;)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\&#39;</span><span class="s1">name</span><span class="se">\&#39;</span><span class="s1">: </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">}),</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">candidateName</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;voters = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">weight</span><span class="se">\&#39;</span><span class="s1">:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;}),</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;linearBallot = {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">linearBallot</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">: [</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;],</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="LinearVotingProfile.showLinearBallots"><a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.showLinearBallots">[docs]</a>    <span class="k">def</span> <span class="nf">showLinearBallots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">IntegerWeights</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        show the linear ballots</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="c1">##        sumWeights = Decimal(&#39;0&#39;)</span>
        <span class="k">if</span> <span class="n">IntegerWeights</span><span class="p">:</span>
            <span class="n">formStr</span> <span class="o">=</span> <span class="s1">&#39; </span><span class="si">%s</span><span class="s1">(</span><span class="si">%.0f</span><span class="s1">):</span><span class="se">\t</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">formStr</span> <span class="o">=</span> <span class="s1">&#39; </span><span class="si">%s</span><span class="s1">(%.f):</span><span class="se">\t</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; voters </span><span class="se">\t</span><span class="s1">      marginal     &#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(weight)</span><span class="se">\t</span><span class="s1"> candidates rankings&#39;</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
<span class="c1">##            sumWeights += self.voters[v][&#39;weight&#39;]</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">formStr</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">])))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;# voters: &#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sumWeights</span><span class="p">))</span></div>

<div class="viewcode-block" id="LinearVotingProfile.computeRankAnalysis"><a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.computeRankAnalysis">[docs]</a>    <span class="k">def</span> <span class="nf">computeRankAnalysis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        compute the number of ranks each candidate obtains</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ranks</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidatesList</span><span class="p">:</span>
            <span class="n">ranks</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="c1">#print(v,i)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                    <span class="c1">#ranks[x][i] += 1</span>
                    <span class="n">ranks</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="c1">#print ranks</span>
        <span class="k">return</span> <span class="n">ranks</span></div>

<div class="viewcode-block" id="LinearVotingProfile.showRankAnalysisTable"><a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.showRankAnalysisTable">[docs]</a>    <span class="k">def</span> <span class="nf">showRankAnalysisTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Sorted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print the rank analysis tableau.</span>
<span class="sd">        </span>
<span class="sd">        If Sorted (True by default), the candidates</span>
<span class="sd">        are ordered by increasing Borda Scores.</span>

<span class="sd">        In case of decimal voters weights, ndigits allows</span>
<span class="sd">        to format the decimal precision of the numerical output.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*----  Borda rank analysis tableau -----*&#39;</span><span class="p">)</span>
        <span class="n">bordaScores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeBordaScores</span><span class="p">()</span> 
        <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[(</span><span class="n">bordaScores</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;BordaScore&#39;</span><span class="p">],</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Sorted</span><span class="p">:</span>
            <span class="n">candidatesList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
        <span class="n">rankIndex</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="n">rankIndex</span><span class="p">)</span>
        <span class="n">ranks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeRankAnalysis</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ranks</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">bordaScores</span><span class="p">)</span>
            
        <span class="c1">## print table</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; candi- | alternative-to-rank       |      Borda&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; dates  | &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rankIndex</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;   &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;| score  average&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-------|-------------------------------------------------&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidatesList</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1"> |&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rankIndex</span><span class="p">:</span>
                <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f &#39;</span> <span class="o">%</span> <span class="n">ndigits</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">ranks</span><span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]][(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;  &#39;</span><span class="p">)</span>
            <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39; | </span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f     </span><span class="si">%%</span><span class="s1">.2f&#39;</span> <span class="o">%</span> <span class="n">ndigits</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">bordaScores</span><span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;BordaScore&#39;</span><span class="p">],</span>\
                                  <span class="n">bordaScores</span><span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;averageBordaScore&#39;</span><span class="p">]))</span>      </div>


<div class="viewcode-block" id="LinearVotingProfile.computeBordaScores"><a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.computeBordaScores">[docs]</a>    <span class="k">def</span> <span class="nf">computeBordaScores</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        compute Borda scores from the rank analysis</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">OrderedDict</span>
        <span class="n">ranks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeRankAnalysis</span><span class="p">()</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidatesList</span><span class="p">:</span>
            <span class="n">BordaScore_x</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="n">BordaScore_x</span> <span class="o">+=</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ranks</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="n">averageBordaScore_x</span> <span class="o">=</span> <span class="n">BordaScore_x</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">sumWeights</span>
            <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">BordaScore_x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">averageBordaScore_x</span><span class="p">))</span>
        <span class="n">scores</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">BordaScores</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],{</span><span class="s1">&#39;BordaScore&#39;</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;averageBordaScore&#39;</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]})</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">BordaScores</span></div>

<div class="viewcode-block" id="LinearVotingProfile.showBordaRanking"><a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.showBordaRanking">[docs]</a>    <span class="k">def</span> <span class="nf">showBordaRanking</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        show Borda ranking in increasing order of the Borda score</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">BordaScores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeBordaScores</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Borda ranking of the candidates&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">BordaScores</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;: &#39;</span><span class="p">,</span><span class="n">BordaScores</span><span class="p">[</span><span class="n">x</span><span class="p">])</span></div>
                  
<div class="viewcode-block" id="LinearVotingProfile.computeBordaWinners"><a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.computeBordaWinners">[docs]</a>    <span class="k">def</span> <span class="nf">computeBordaWinners</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        compute the Borda winner from the Borda scores, ie the list of</span>
<span class="sd">        candidates with the minimal Borda score.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">BordaScores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeBordaScores</span><span class="p">()</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
        <span class="n">BordaMinimum</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">m</span>
        <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidatesList</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">BordaMinimum</span> <span class="o">&gt;</span> <span class="n">BordaScores</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;BordaScore&#39;</span><span class="p">]:</span>
                <span class="n">BordaMinimum</span> <span class="o">=</span> <span class="n">BordaScores</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;BordaScore&#39;</span><span class="p">]</span>
        <span class="n">winners</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">BordaScores</span> <span class="k">if</span> <span class="n">BordaScores</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;BordaScore&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">BordaMinimum</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">winners</span></div>

<div class="viewcode-block" id="LinearVotingProfile.computeInstantRunoffWinner"><a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.computeInstantRunoffWinner">[docs]</a>    <span class="k">def</span> <span class="nf">computeInstantRunoffWinner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        compute the instant runoff winner from a linear voting ballot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span><span class="p">,</span><span class="n">copy</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">)</span>
        <span class="n">votersList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">]</span>
        <span class="n">totalWeight</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;0.0&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">votersList</span><span class="p">:</span>
            <span class="n">totalWeight</span> <span class="o">+=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span> <span class="p">)</span>
        <span class="n">halfWeight</span> <span class="o">=</span> <span class="n">totalWeight</span><span class="o">/</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;2.0&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total number of votes = &#39;</span><span class="p">,</span> <span class="n">totalWeight</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Half of the Votes = &#39;</span><span class="p">,</span> <span class="n">halfWeight</span><span class="p">)</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">)</span>
        <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">]</span>
        <span class="n">remainingCandidates</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
        <span class="n">remainingLinearBallot</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span><span class="p">)</span>
        <span class="n">stage</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">remainingCandidates</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">uninominalVotes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeUninominalVotes</span><span class="p">(</span><span class="n">remainingCandidates</span><span class="p">,</span><span class="n">remainingLinearBallot</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; ==&gt; stage = &#39;</span><span class="p">,</span> <span class="n">stage</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    remaining candidates&#39;</span><span class="p">,</span> <span class="n">remainingCandidates</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    uninominal votes&#39;</span><span class="p">,</span> <span class="n">uninominalVotes</span><span class="p">)</span>
            <span class="n">minVotes</span> <span class="o">=</span> <span class="n">totalWeight</span>
            <span class="n">maxVotes</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;0.0&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">uninominalVotes</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">uninominalVotes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">minVotes</span><span class="p">:</span>
                    <span class="n">minVotes</span> <span class="o">=</span> <span class="n">uninominalVotes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">uninominalVotes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">maxVotes</span><span class="p">:</span>
                    <span class="n">maxVotes</span> <span class="o">=</span> <span class="n">uninominalVotes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    minimal number of votes = &#39;</span><span class="p">,</span> <span class="n">minVotes</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    maximal number of votes = &#39;</span><span class="p">,</span> <span class="n">maxVotes</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">maxVotes</span> <span class="o">&lt;=</span> <span class="n">halfWeight</span><span class="p">:</span>
                <span class="n">currentCandidates</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">remainingCandidates</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">currentCandidates</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">uninominalVotes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">minVotes</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    candidate to remove = &#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
                        <span class="n">remainingCandidates</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">remainingLinearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="k">pass</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    remaining candidates = &#39;</span><span class="p">,</span> <span class="n">remainingCandidates</span><span class="p">)</span>
                    <span class="c1">#print &#39;    remaining ballots    = &#39;, remainingLinearBallot</span>
                <span class="n">stage</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">remainingCandidates</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">uninominalVotes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">maxVotes</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    candidate </span><span class="si">%s</span><span class="s1"> obtains an absolute majority&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
                        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">remainingCandidates</span></div>

<div class="viewcode-block" id="LinearVotingProfile.save2PerfTab"><a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.save2PerfTab">[docs]</a>    <span class="k">def</span> <span class="nf">save2PerfTab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;votingPerfTab&#39;</span><span class="p">,</span><span class="n">isDecimal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">valueDigits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">_NegativeWeights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Persistant storage of a linear voting profile in the format of a rank performance Tableau.</span>
<span class="sd">        For each voter *v*, the rank performance of candidate *x* corresponds to:</span>

<span class="sd">        number of candidates - linearProfile[v].index(x)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*--- Saving as performance tableau in file: &lt;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.py&gt; ---*&#39;</span><span class="p">)</span>
        <span class="n">objectives</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">fileNameExt</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.py&#39;</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileNameExt</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Saved performance Tableau: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from decimal import Decimal</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from collections import OrderedDict</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># actions</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;actions = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%s</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">it</span><span class="p">]))</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}),</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># no objectives</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;objectives = OrderedDict()</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>            
        <span class="c1"># criteria</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;criteria = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> 
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">g</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">it</span> <span class="o">==</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">_NegativeWeights</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%s</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="nb">repr</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">it</span><span class="p">])))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%s</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">it</span><span class="p">])))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%s</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">it</span><span class="p">])))</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">scale</span><span class="se">\&#39;</span><span class="s2">:(Decimal(1),Decimal(</span><span class="si">%d</span><span class="s2">)),</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">nc</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">preferenceDirection</span><span class="se">\&#39;</span><span class="s2">: </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="s1">&#39;min&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}),</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># evaluation</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;evaluation = {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">: {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Decimal</span><span class="p">:</span>
                    <span class="c1">#fo.write(&#39;\&#39;&#39; + str(x) + &#39;\&#39;:Decimal(&quot;&#39; + str(evaluation[g][x]) + &#39;&quot;),\n&#39;)</span>
                    <span class="n">evaluationString</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%%</span><span class="s1">s</span><span class="se">\&#39;</span><span class="s1">:Decimal(&quot;</span><span class="si">%%</span><span class="s1">.</span><span class="si">%d</span><span class="s1">f&quot;),</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">valueDigits</span><span class="p">)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">xval</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span><span class="p">[</span><span class="n">g</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">xval</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
                    <span class="k">if</span> <span class="n">_NegativeWeights</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">evaluationString</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">xval</span><span class="p">))))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">evaluationString</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">xval</span><span class="p">))))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;},</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="LinearVotingProfile.showHTMLVotingHeatmap"><a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.showHTMLVotingHeatmap">[docs]</a>    <span class="k">def</span> <span class="nf">showHTMLVotingHeatmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">criteriaList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> \
                              <span class="n">actionsList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>\
                              <span class="n">fromIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>\
                              <span class="n">toIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>\
                              <span class="n">Transposed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>\
                              <span class="n">SparseModel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>\
                              <span class="n">minimalComponentSize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> \
                              <span class="n">rankingRule</span><span class="o">=</span><span class="s1">&#39;Copeland&#39;</span><span class="p">,</span>\
                              <span class="n">quantiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>\
                              <span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">,</span> \
                              <span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>\
                              <span class="n">colorLevels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> \
                              <span class="n">pageTitle</span><span class="o">=</span><span class="s1">&#39;Voting Heatmap&#39;</span><span class="p">,</span> \
                              <span class="n">Correlations</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>\
                              <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>\
                              <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>\
                              <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show the linear voting profile as a rank performance heatmap.</span>
<span class="sd">        The linear voting profile is previously saved to a stored Performance Tableau.</span>
<span class="sd">        </span>
<span class="sd">        (see perfTabs.PerformanceTableau.showHTMLPerformanceHeatmap() )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">mkdtemp</span>
        <span class="n">tempDir</span> <span class="o">=</span> <span class="n">mkdtemp</span><span class="p">()</span>
        <span class="n">perfTabFileName</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/votingPerfTab&#39;</span> <span class="o">%</span> <span class="n">tempDir</span>
        <span class="k">if</span> <span class="n">SparseModel</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save2PerfTab</span><span class="p">(</span><span class="n">perfTabFileName</span><span class="p">,</span><span class="n">_NegativeWeights</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save2PerfTab</span><span class="p">(</span><span class="n">perfTabFileName</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">PerformanceTableau</span><span class="p">(</span><span class="n">perfTabFileName</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">showHTMLPerformanceHeatmap</span><span class="p">(</span><span class="n">criteriaList</span><span class="o">=</span><span class="n">criteriaList</span><span class="p">,</span> <span class="n">actionsList</span><span class="o">=</span><span class="n">actionsList</span><span class="p">,</span> \
                               <span class="n">fromIndex</span><span class="o">=</span><span class="n">fromIndex</span><span class="p">,</span><span class="n">toIndex</span><span class="o">=</span><span class="n">toIndex</span><span class="p">,</span><span class="n">Transposed</span><span class="o">=</span><span class="n">Transposed</span><span class="p">,</span>\
                              <span class="n">SparseModel</span><span class="o">=</span><span class="n">SparseModel</span><span class="p">,</span> <span class="n">minimalComponentSize</span><span class="o">=</span><span class="n">minimalComponentSize</span><span class="p">,</span> \
                              <span class="n">rankingRule</span><span class="o">=</span><span class="n">rankingRule</span><span class="p">,</span> <span class="n">quantiles</span><span class="o">=</span><span class="n">quantiles</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">,</span> \
                              <span class="n">ndigits</span><span class="o">=</span><span class="n">ndigits</span><span class="p">,</span> <span class="n">colorLevels</span><span class="o">=</span><span class="n">colorLevels</span><span class="p">,</span> \
                              <span class="n">pageTitle</span><span class="o">=</span><span class="n">pageTitle</span><span class="p">,</span> <span class="n">Correlations</span><span class="o">=</span><span class="n">Correlations</span><span class="p">,</span>\
                              <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span> <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">,</span> <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span></div>
    


<div class="viewcode-block" id="LinearVotingProfile.computeUninominalVotes"><a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.computeUninominalVotes">[docs]</a>    <span class="k">def</span> <span class="nf">computeUninominalVotes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">candidates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">linearBallot</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        compute uninominal votes for each candidate in candidates sublist</span>
<span class="sd">        and restricted linear ballots</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">candidates</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
            <span class="n">candidates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span>
        <span class="k">if</span> <span class="n">linearBallot</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">linearBallot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span>
        <span class="n">uninominalVotes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="n">uninominalVotes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">:</span>
                    <span class="n">uninominalVotes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">uninominalVotes</span></div>

<div class="viewcode-block" id="LinearVotingProfile.computeSimpleMajorityWinner"><a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.computeSimpleMajorityWinner">[docs]</a>    <span class="k">def</span> <span class="nf">computeSimpleMajorityWinner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        compute the winner in a uninominal Election from a linear ballot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">uv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeUninominalVotes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;uninominal votes &#39;</span><span class="p">,</span> <span class="n">uv</span><span class="p">)</span>
        <span class="n">maxVotes</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">uv</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">maxVotes</span><span class="p">:</span>
                <span class="n">maxVotes</span> <span class="o">=</span> <span class="n">uv</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;maxVotes &#39;</span><span class="p">,</span> <span class="n">maxVotes</span><span class="p">)</span>
        <span class="n">simpleMajorityWinner</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">uv</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">maxVotes</span><span class="p">:</span>
                <span class="n">simpleMajorityWinner</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;simple majority winner(s) &#39;</span><span class="p">,</span> <span class="n">simpleMajorityWinner</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">simpleMajorityWinner</span></div></div>


<div class="viewcode-block" id="ApprovalVotingProfile"><a class="viewcode-back" href="../techDoc.html#votingProfiles.ApprovalVotingProfile">[docs]</a><span class="k">class</span> <span class="nc">ApprovalVotingProfile</span><span class="p">(</span><span class="n">VotingProfile</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A specialised class for approval voting profiles</span>

<span class="sd">    Structure::</span>

<span class="sd">        candidates = OrderedDict([(&#39;a&#39;, {&#39;name&#39;: ...}),</span>
<span class="sd">                      (&#39;b&#39;, {&#39;name&#39;: ...}),</span>
<span class="sd">                      ..., ...])</span>
<span class="sd">        voters = OrderedDict([(&#39;v1&#39;,{&#39;weight&#39;:1.0}),(&#39;v2&#39;:{&#39;weight&#39;:1.0}), ...])</span>
<span class="sd">        ## each specifies the subset of candidates he approves on</span>
<span class="sd">        approvalBallot = {</span>
<span class="sd">            &#39;v1&#39; : [&#39;b&#39;],</span>
<span class="sd">            &#39;v2&#39; : [&#39;a&#39;,&#39;b&#39;],</span>
<span class="sd">            ...</span>
<span class="sd">            }</span>

<span class="sd">        ## each specifies the subset -disjoint from the approvalBallot-  of candidates he disapproves on</span>
<span class="sd">        disApprovalBallot = {</span>
<span class="sd">            &#39;v1&#39; : [&#39;a&#39;],</span>
<span class="sd">            &#39;v2&#39; : [],</span>
<span class="sd">            ...</span>
<span class="sd">            }</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileVotingProfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">fileVotingProfile</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">fileVotingProfile</span> <span class="o">+</span> <span class="s1">&#39;.py&#39;</span>
        <span class="c1">## else:</span>
        <span class="c1">##     fileName = &#39;testapprovalvotingprofile.py&#39;</span>
            <span class="n">argDict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">exec</span><span class="p">(</span><span class="nb">compile</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">fileName</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">),</span><span class="n">argDict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileVotingProfile</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;candidates&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">voters</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;voters&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;approvalBallot&#39;</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">disApprovalBallot</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;disApprovalBallot&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">disApprovalBallot</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">disApprovalBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeBallot</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">randv</span> <span class="o">=</span> <span class="n">RandomApprovalVotingProfile</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;randApprovalVotingProfile&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="n">randv</span><span class="o">.</span><span class="n">candidates</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">voters</span> <span class="o">=</span> <span class="n">randv</span><span class="o">.</span><span class="n">voters</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="n">randv</span><span class="o">.</span><span class="n">ballot</span>

<div class="viewcode-block" id="ApprovalVotingProfile.showApprovalResults"><a class="viewcode-back" href="../techDoc.html#votingProfiles.ApprovalVotingProfile.showApprovalResults">[docs]</a>    <span class="k">def</span> <span class="nf">showApprovalResults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the approval obtained by each candidates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Approval results&#39;</span><span class="p">)</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="c1">#candidates.sort()</span>
        <span class="n">votesPerCandidate</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="n">votesPerCandidate</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">ballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ballot</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
                <span class="n">votesPerCandidate</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">votesPerCandidate</span><span class="p">[</span><span class="n">c</span><span class="p">]),</span><span class="n">c</span><span class="p">))</span>
        <span class="n">results</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;candidate: </span><span class="si">%s</span><span class="s1"> obtains </span><span class="si">%d</span><span class="s1"> votes&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">))</span></div>

<div class="viewcode-block" id="ApprovalVotingProfile.showDisApprovalResults"><a class="viewcode-back" href="../techDoc.html#votingProfiles.ApprovalVotingProfile.showDisApprovalResults">[docs]</a>    <span class="k">def</span> <span class="nf">showDisApprovalResults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the disapprovals obtained by each candidates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Disapproval results&#39;</span><span class="p">)</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="c1">#candidates.sort()</span>
        <span class="n">votesPerCandidate</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="n">votesPerCandidate</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">ballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">disApprovalBallot</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ballot</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
                <span class="n">votesPerCandidate</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">votesPerCandidate</span><span class="p">[</span><span class="n">c</span><span class="p">]),</span><span class="n">c</span><span class="p">))</span>
        <span class="n">results</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;candidate: </span><span class="si">%s</span><span class="s1"> obtains </span><span class="si">%d</span><span class="s1"> votes&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">))</span></div>

    <span class="k">def</span> <span class="nf">showResults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showApprovalResults</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showDisApprovalResults</span><span class="p">()</span>

<div class="viewcode-block" id="ApprovalVotingProfile.computeBallot"><a class="viewcode-back" href="../techDoc.html#votingProfiles.ApprovalVotingProfile.computeBallot">[docs]</a>    <span class="k">def</span> <span class="nf">computeBallot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes a complete ballot from the approval Ballot.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            approvalEquivalence=False, disapprovalEquivalence=False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">)</span>
        <span class="n">AVballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span>
        <span class="n">DAVBallot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">disApprovalBallot</span>
        <span class="n">ballot</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">AVballot</span><span class="p">:</span>
            <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                    <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;0.0&quot;</span><span class="p">)</span>
            <span class="n">voted</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">AVballot</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
            <span class="n">non_voted</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">DAVBallot</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
            <span class="n">maybe</span> <span class="o">=</span> <span class="n">candidates</span> <span class="o">-</span> <span class="p">(</span><span class="n">voted</span> <span class="o">|</span> <span class="n">non_voted</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">voted</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">voted</span><span class="p">:</span>
                            <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;0.0&quot;</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">voted</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">maybe</span><span class="p">:</span>
                            <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;1.0&quot;</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">voted</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">non_voted</span><span class="p">:</span>
                            <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;1.0&quot;</span><span class="p">)</span>   
                        <span class="k">elif</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">maybe</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">voted</span><span class="p">:</span>
                            <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;-1.0&quot;</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">maybe</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">maybe</span><span class="p">:</span>
                            <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;0.0&quot;</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">maybe</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">non_voted</span><span class="p">:</span>
                            <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;1.0&quot;</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">non_voted</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">voted</span><span class="p">:</span>
                            <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;-1.0&quot;</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">non_voted</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">maybe</span><span class="p">:</span>
                            <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;-1.0&quot;</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">non_voted</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">non_voted</span><span class="p">:</span>
                            <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;0.0&quot;</span><span class="p">)</span>    
        <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="n">ballot</span>
        <span class="k">return</span> <span class="n">ballot</span></div>

<span class="c1">##    def computeBallot(self,approvalEquivalence=False,disapprovalEquivalence=False):</span>
<span class="c1">##        &quot;&quot;&quot;</span>
<span class="c1">##        Computes a complete ballot from the approval Ballot.</span>
<span class="c1">##</span>
<span class="c1">##        Parameters:</span>
<span class="c1">##            approvalEquivalence=False, disapprovalEquivalence=False.</span>
<span class="c1">##        &quot;&quot;&quot;</span>
<span class="c1">##        candidates = set(self.candidates)</span>
<span class="c1">##        AVballot = self.approvalBallot</span>
<span class="c1">##        ballot = {}</span>
<span class="c1">##        for v in AVballot:</span>
<span class="c1">##            ballot[v] = {}</span>
<span class="c1">##            for x in candidates:</span>
<span class="c1">##                ballot[v][x] = {}</span>
<span class="c1">##                for y in candidates:</span>
<span class="c1">##                    ballot[v][x][y] = Decimal(&quot;0.0&quot;)</span>
<span class="c1">##            voted = set(AVballot[v])</span>
<span class="c1">##            non_voted = candidates - voted</span>
<span class="c1">##            if approvalEquivalence:</span>
<span class="c1">##                for x in voted:</span>
<span class="c1">##                    for y in voted:</span>
<span class="c1">##                        ballot[v][x][y] = Decimal(&quot;1.0&quot;)</span>
<span class="c1">##            if disapprovalEquivalence:</span>
<span class="c1">##                for x in non_voted:</span>
<span class="c1">##                    for y in non_voted:</span>
<span class="c1">##                        ballot[v][x][y] = Decimal(&quot;1.0&quot;)</span>
<span class="c1">##            for x in voted:</span>
<span class="c1">##                for y in non_voted:</span>
<span class="c1">##                    ballot[v][x][y] = Decimal(&quot;1.0&quot;)</span>
<span class="c1">##                    ballot[v][y][x] = Decimal(&quot;-1.0&quot;)</span>
<span class="c1">##            for x in candidates:</span>
<span class="c1">##                ballot[v][x][x] = Decimal(&quot;-1.0&quot;)</span>
<span class="c1">##        self.ballot = ballot</span>
<span class="c1">##        return ballot</span>

<div class="viewcode-block" id="ApprovalVotingProfile.save"><a class="viewcode-back" href="../techDoc.html#votingProfiles.ApprovalVotingProfile.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;tempAVprofile&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Persistant storage of an approval voting profile.</span>

<span class="sd">        Parameter:</span>
<span class="sd">            name of file (without &lt;.py&gt; extension!).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*--- Saving AV profile in file: &lt;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.py&gt; ---*&#39;</span><span class="p">)</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
        <span class="n">approvalBallot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span>
        <span class="n">saveFileName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.py&#39;</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">saveFileName</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Saved approval voting profile: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from collections import OrderedDict </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;candidates = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">candidateName</span> <span class="o">=</span> <span class="n">candidates</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">candidateName</span> <span class="o">=</span> <span class="n">x</span>
            <span class="c1">#fo.write(&#39;\&#39;&#39; + str(x) + &#39;\&#39;: {\&#39;name\&#39;: \&#39;&#39; + str(x)+ &#39;\&#39;},\n&#39;)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\&#39;</span><span class="s1">name</span><span class="se">\&#39;</span><span class="s1">: </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">}),</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">candidateName</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;voters = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">weight</span><span class="se">\&#39;</span><span class="s1">:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;}),</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;approvalBallot = {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">approvalBallot</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">: [</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">approvalBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;],</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="ApprovalVotingProfile.save2PerfTab"><a class="viewcode-back" href="../techDoc.html#votingProfiles.ApprovalVotingProfile.save2PerfTab">[docs]</a>    <span class="k">def</span> <span class="nf">save2PerfTab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;votingPerfTab&#39;</span><span class="p">,</span><span class="n">isDecimal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">valueDigits</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Persistant storage of an approval voting profile in the format of a standard performance tableau.</span>
<span class="sd">        For each voter *v*, the performance of candidate *x* corresponds to:</span>

<span class="sd">              1, if approved;</span>
<span class="sd">              0, if disapproved;</span>
<span class="sd">              -999, miising evalaution otherwise,</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*--- Saving as performance tableau in file: &lt;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.py&gt; ---*&#39;</span><span class="p">)</span>
        <span class="n">objectives</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">fileNameExt</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.py&#39;</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileNameExt</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Saved performance Tableau: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from decimal import Decimal</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from collections import OrderedDict</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># actions</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;actions = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%s</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">it</span><span class="p">]))</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}),</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># no objectives</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;objectives = OrderedDict()</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>            
        <span class="c1"># criteria</span>
        <span class="n">minScale</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">maxScale</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;criteria = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> 
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">g</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%s</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">it</span><span class="p">])))</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">scale</span><span class="se">\&#39;</span><span class="s2">:(Decimal(</span><span class="se">\&#39;</span><span class="si">%d</span><span class="se">\&#39;</span><span class="s2">),Decimal(</span><span class="se">\&#39;</span><span class="si">%d</span><span class="se">\&#39;</span><span class="s2">)),</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">minScale</span><span class="p">,</span><span class="n">maxScale</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}),</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># evaluation</span>
        <span class="n">AVballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span>
        <span class="n">DAVBallot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">disApprovalBallot</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;evaluation = {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">: {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">approved</span> <span class="o">=</span> <span class="n">AVballot</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
            <span class="n">disapproved</span> <span class="o">=</span> <span class="n">DAVBallot</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Decimal</span><span class="p">:</span>
                    <span class="c1">#fo.write(&#39;\&#39;&#39; + str(x) + &#39;\&#39;:Decimal(&quot;&#39; + str(evaluation[g][x]) + &#39;&quot;),\n&#39;)</span>
                    <span class="n">evaluationString</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%%</span><span class="s1">s</span><span class="se">\&#39;</span><span class="s1">:Decimal(&quot;</span><span class="si">%%</span><span class="s1">.</span><span class="si">%d</span><span class="s1">f&quot;),</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">valueDigits</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">approved</span><span class="p">:</span>
                        <span class="n">xval</span> <span class="o">=</span> <span class="n">maxScale</span>
                    <span class="k">elif</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">disapproved</span><span class="p">:</span>
                        <span class="n">xval</span> <span class="o">=</span> <span class="n">minScale</span>
                    <span class="k">else</span><span class="p">:</span>  <span class="c1"># ,issing evaluation</span>
                        <span class="n">xval</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">evaluationString</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">xval</span><span class="p">))))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;},</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="RandomApprovalVotingProfile"><a class="viewcode-back" href="../techDoc.html#votingProfiles.RandomApprovalVotingProfile">[docs]</a><span class="k">class</span> <span class="nc">RandomApprovalVotingProfile</span><span class="p">(</span><span class="n">ApprovalVotingProfile</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A specialized class for generating random approval voting profiles.</span>

<span class="sd">    *Parameters*</span>
<span class="sd">        * *minSizeBallot* : integer, determines the minimum of</span>
<span class="sd">           candidates that must be approved.</span>
<span class="sd">        * *maxSizeBallot* : integer, determines the maximum of</span>
<span class="sd">          candidates that may be approved.</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">numberOfVoters</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">numberOfCandidates</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                 <span class="n">minSizeOfBallot</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">maxSizeOfBallot</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Random profile creation parameters:</span>
<span class="sd">            | numberOfVoters=9, numberOfCandidates=5,</span>
<span class="sd">            | minSizeOfBallot=1, maxSizeOfBallot=2.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="c1">##        import random</span>
<span class="c1">##        random.seed(seed)</span>
        <span class="n">votersList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">numberOfVoters</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">votersList</span><span class="p">:</span>
            <span class="n">voterID</span> <span class="o">=</span> <span class="s1">&#39;v</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">v</span>
            <span class="n">voters</span><span class="p">[</span><span class="n">voterID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">}</span>
        <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">numberOfCandidates</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidatesList</span><span class="p">:</span>
            <span class="n">candidateID</span> <span class="o">=</span> <span class="s1">&#39;a</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">c</span>
            <span class="n">candidates</span><span class="p">[</span><span class="n">candidateID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">candidateID</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;randAVProfile&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="n">candidates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">voters</span> <span class="o">=</span> <span class="n">voters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generateRandomApprovalBallot</span><span class="p">(</span><span class="n">minSizeOfBallot</span><span class="p">,</span><span class="n">maxSizeOfBallot</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disApprovalBallot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generateRandomDisApprovalBallot</span><span class="p">(</span><span class="n">minSizeOfBallot</span><span class="p">,</span><span class="n">maxSizeOfBallot</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeBallot</span><span class="p">()</span>

<div class="viewcode-block" id="RandomApprovalVotingProfile.generateRandomApprovalBallot"><a class="viewcode-back" href="../techDoc.html#votingProfiles.RandomApprovalVotingProfile.generateRandomApprovalBallot">[docs]</a>    <span class="k">def</span> <span class="nf">generateRandomApprovalBallot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">minSizeOfBallot</span><span class="p">,</span><span class="n">maxSizeOfBallot</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a randomly generated approval ballot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">random</span><span class="o">,</span><span class="nn">copy</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">approvalBallot</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="n">candidatesList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">candidates</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">approvalBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">nb</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">minSizeOfBallot</span><span class="p">,</span><span class="n">maxSizeOfBallot</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">candidatesList</span> <span class="o">!=</span> <span class="p">[]:</span>
                    <span class="n">bx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
                    <span class="n">approvalBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bx</span><span class="p">)</span>
                    <span class="n">candidatesList</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">bx</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">approvalBallot</span></div>

<div class="viewcode-block" id="RandomApprovalVotingProfile.generateRandomDisApprovalBallot"><a class="viewcode-back" href="../techDoc.html#votingProfiles.RandomApprovalVotingProfile.generateRandomDisApprovalBallot">[docs]</a>    <span class="k">def</span> <span class="nf">generateRandomDisApprovalBallot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">minSizeOfBallot</span><span class="p">,</span><span class="n">maxSizeOfBallot</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a randomly generated disapproval ballot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">random</span><span class="o">,</span><span class="nn">copy</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">disApprovalBallot</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="n">candidatesList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">candidates</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">disApprovalBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">nb</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">minSizeOfBallot</span><span class="p">,</span><span class="n">maxSizeOfBallot</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">candidatesList</span> <span class="o">!=</span> <span class="p">[]:</span>
                    <span class="n">bx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">bx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
                        <span class="n">disApprovalBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bx</span><span class="p">)</span>
                    <span class="n">candidatesList</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">bx</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">disApprovalBallot</span></div></div>

<div class="viewcode-block" id="RandomLinearVotingProfile"><a class="viewcode-back" href="../techDoc.html#votingProfiles.RandomLinearVotingProfile">[docs]</a><span class="k">class</span> <span class="nc">RandomLinearVotingProfile</span><span class="p">(</span><span class="n">LinearVotingProfile</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A specialized class for generating random linwear voting profiles.</span>

<span class="sd">    *Parameters*   </span>
<span class="sd">        * When *WithPolls* is True, each party supporting voter&#39;s linear ballot is randomly oriented</span>
<span class="sd">          by one of two random exponential poll results. The corresponding polls are stored</span>
<span class="sd">          in self.poll1, respectively self.poll2.</span>
<span class="sd">        * The *partyRepartition* sets the theoretical distribution of the two polls over the</span>
<span class="sd">          set of voters. If set to 0.0 or 1.0, only self.poll2, resp. self.poll1, will orient</span>
<span class="sd">          the respective party supporters.</span>
<span class="sd">        * The *other* paraemter sets the theoretical proportion of non party supporters.</span>
<span class="sd">        * The *votersWeights* parameter may be a list of positive integers in order to</span>
<span class="sd">          deterministically attribute weights to the voters.</span>
<span class="sd">          Is ignored when *RandomWeights* is True.</span>
<span class="sd">        * When *voterWeights* are None and *RandomWeights* is False, each voter</span>
<span class="sd">          obtains a single vote (default setting).</span>
<span class="sd">          </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">numberOfVoters</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                 <span class="n">numberOfCandidates</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                 <span class="n">WithPolls</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">partyRepartition</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                 <span class="n">other</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                 <span class="n">votersWeights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">RandomWeights</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="k">if</span> <span class="n">seed</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">seed</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">votersList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">numberOfVoters</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">nd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">numberOfVoters</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">votersList</span><span class="p">:</span>
            <span class="n">voterID</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;v</span><span class="si">%%</span><span class="s1">0</span><span class="si">%d</span><span class="s1">d&#39;</span> <span class="o">%</span> <span class="n">nd</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">votersWeights</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">weight</span> <span class="o">=</span> <span class="n">votersWeights</span><span class="p">[</span><span class="n">v</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">weight</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">RandomWeights</span><span class="p">:</span>
                    <span class="n">weight</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">numberOfVoters</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">weight</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">voters</span><span class="p">[</span><span class="n">voterID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">weight</span><span class="p">)}</span>
        <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">numberOfCandidates</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">numberOfCandidates</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidatesList</span><span class="p">:</span>
            <span class="n">candidateID</span> <span class="o">=</span><span class="p">(</span><span class="s1">&#39;a</span><span class="si">%%</span><span class="s1">0</span><span class="si">%d</span><span class="s1">d&#39;</span> <span class="o">%</span> <span class="n">na</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">candidates</span><span class="p">[</span><span class="n">candidateID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">candidateID</span><span class="p">}</span>
        <span class="c1"># store instance attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;randLinearProfile&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="n">candidates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">voters</span> <span class="o">=</span> <span class="n">voters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RandomWeights</span> <span class="o">=</span> <span class="n">RandomWeights</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sumWeights</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sumWeights</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">WithPolls</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span> <span class="o">=</span>\
                <span class="bp">self</span><span class="o">.</span><span class="n">generateRandomLinearBallotWithPoll</span><span class="p">(</span><span class="n">partyRepartition</span><span class="o">=</span><span class="n">partyRepartition</span><span class="p">,</span>
                                                        <span class="n">other</span><span class="o">=</span><span class="n">other</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generateRandomLinearBallot</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeBallot</span><span class="p">()</span>


<div class="viewcode-block" id="RandomLinearVotingProfile.generateRandomLinearBallot"><a class="viewcode-back" href="../techDoc.html#votingProfiles.RandomLinearVotingProfile.generateRandomLinearBallot">[docs]</a>    <span class="k">def</span> <span class="nf">generateRandomLinearBallot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">seed</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a randomly generated linear ballot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">linearBallot</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
        <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="c1">#print candidatesList</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
            <span class="c1">#print candidateList</span>
            <span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">candidatesList</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">linearBallot</span></div>

<div class="viewcode-block" id="RandomLinearVotingProfile.generateRandomLinearBallotWithPoll"><a class="viewcode-back" href="../techDoc.html#votingProfiles.RandomLinearVotingProfile.generateRandomLinearBallotWithPoll">[docs]</a>    <span class="k">def</span> <span class="nf">generateRandomLinearBallotWithPoll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">partyRepartition</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">other</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a random linear ballot in accordance with the given polls:</span>
<span class="sd">        self.poll1 and self.poll2.</span>

<span class="sd">        Polls are distributed in the *bipartisan* proportion.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">randomNumbers</span> <span class="kn">import</span> <span class="n">DiscreteRandomVariable</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
        <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>

<span class="c1">##        # inverse polls</span>
<span class="c1">##        poll = []</span>
<span class="c1">##        sumPoll = 0.0</span>
<span class="c1">##        for c in candidatesList:</span>
<span class="c1">##            valc = random.expovariate(1)</span>
<span class="c1">##            poll.append( (valc,c) )</span>
<span class="c1">##            sumPoll += valc</span>
<span class="c1">##        poll.sort(reverse=True)</span>
<span class="c1">##        poll1 = {}</span>
<span class="c1">##        poll2 = {}</span>
<span class="c1">##        for i in range(nc):</span>
<span class="c1">##            ci1 = poll[i][1]</span>
<span class="c1">##            ci2 = poll[-1-i][1]</span>
<span class="c1">##            xci = poll[i][0]/sumPoll</span>
<span class="c1">##            poll1[ci1] = xci</span>
<span class="c1">##            poll2[ci2] = xci</span>
           
        <span class="c1"># independent polls</span>
        <span class="n">poll1</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">sumPoll</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidatesList</span><span class="p">:</span>
            <span class="n">poll1</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">expovariate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">sumPoll</span> <span class="o">+=</span> <span class="n">poll1</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">poll1</span><span class="p">:</span>
            <span class="n">poll1</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">/=</span> <span class="n">sumPoll</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">poll1</span> <span class="o">=</span> <span class="n">poll1</span>
        <span class="n">poll2</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">sumPoll</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidatesList</span><span class="p">:</span>
            <span class="n">poll2</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">expovariate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">sumPoll</span> <span class="o">+=</span> <span class="n">poll2</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">poll2</span><span class="p">:</span>
            <span class="n">poll2</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">/=</span> <span class="n">sumPoll</span>

        <span class="c1"># storing polls    </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">poll1</span> <span class="o">=</span> <span class="n">poll1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">poll2</span> <span class="o">=</span> <span class="n">poll2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">other</span> <span class="o">=</span> <span class="n">other</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">partyRepartition</span> <span class="o">=</span> <span class="n">partyRepartition</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">poll1</span><span class="p">,</span><span class="n">poll2</span><span class="p">,</span><span class="n">other</span><span class="p">,</span><span class="n">partyRepartition</span><span class="p">)</span>

        <span class="c1"># generating random linear ballots</span>
        <span class="n">linearBallot</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="c1"># each voter is attached to one of the polls</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">u</span> <span class="o">&lt;</span> <span class="n">other</span><span class="p">:</span> <span class="c1"># random voting</span>
                <span class="n">otherCandidatesList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
                <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">otherCandidatesList</span><span class="p">)</span>
                <span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;party&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">otherCandidatesList</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># poll driven random</span>
                
                <span class="k">if</span> <span class="n">partyRepartition</span> <span class="o">&lt;</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">():</span>
                    <span class="n">pollv</span> <span class="o">=</span> <span class="n">poll1</span>
                    <span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;party&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pollv</span> <span class="o">=</span> <span class="n">poll2</span>
                    <span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;party&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="c1"># generating a random linear ranking    </span>
                <span class="n">shuffledCandidatesList</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">NotShuffled</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">currPoll</span> <span class="o">=</span> <span class="n">pollv</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="n">rdv</span> <span class="o">=</span> <span class="n">DiscreteRandomVariable</span><span class="p">(</span><span class="n">currPoll</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="n">j</span><span class="p">)</span>
                    <span class="k">while</span> <span class="n">NotShuffled</span><span class="p">:</span>
                        <span class="n">xc</span> <span class="o">=</span> <span class="n">rdv</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
                        <span class="k">if</span> <span class="n">xc</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">shuffledCandidatesList</span><span class="p">:</span>
                            <span class="n">NotShuffled</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">shuffledCandidatesList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xc</span><span class="p">)</span>
                    <span class="n">currPoll</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">xc</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">shuffledCandidatesList</span><span class="p">)</span>
                            
                <span class="n">shc</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">shuffledCandidatesList</span><span class="p">)</span>
                <span class="n">sc</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
                <span class="n">xc</span> <span class="o">=</span> <span class="p">(</span><span class="n">sc</span><span class="o">-</span><span class="n">shc</span><span class="p">)</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">shuffledCandidatesList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xc</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==&gt;&gt;&#39;</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span><span class="n">shuffledCandidatesList</span><span class="p">)</span>           
                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">shuffledCandidatesList</span>
            
        <span class="k">return</span> <span class="n">linearBallot</span></div>

<div class="viewcode-block" id="RandomLinearVotingProfile.showRandomPolls"><a class="viewcode-back" href="../techDoc.html#votingProfiles.RandomLinearVotingProfile.showRandomPolls">[docs]</a>    <span class="k">def</span> <span class="nf">showRandomPolls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shows the random polls, the case given.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">poll1</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">poll1</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">poll1</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">poll1</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">poll1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nc</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
            <span class="n">nv</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">voters</span><span class="p">)</span>
            <span class="n">supportersParty1</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">voters</span> <span class="k">if</span> <span class="n">voters</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;party&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">supportersParty2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">voters</span> <span class="k">if</span> <span class="n">voters</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;party&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
            <span class="n">otherSupporters</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">voters</span> <span class="k">if</span> <span class="n">voters</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;party&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">n0</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">otherSupporters</span><span class="p">)</span>
            <span class="n">p0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">n0</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">nv</span><span class="p">)</span>
            <span class="n">n1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">supportersParty1</span><span class="p">)</span>
            <span class="n">p1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">nv</span><span class="p">)</span>
            <span class="n">n2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">supportersParty2</span><span class="p">)</span>
            <span class="n">p2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">nv</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">p1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">n0</span><span class="p">,</span><span class="n">p0</span><span class="p">)</span>
            <span class="n">poll1</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">poll2</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">poll2</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">poll2</span><span class="p">]</span>
            <span class="n">poll2</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">poll</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">poll1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span>\
                      <span class="n">p2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">poll2</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                <span class="n">poll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">poll</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1"># print polls</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Random repartition of voters&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Party_1 supporters : </span><span class="si">%d</span><span class="s1"> (</span><span class="si">%05.2f%%</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">p1</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Party_2 supporters : </span><span class="si">%d</span><span class="s1"> (</span><span class="si">%05.2f%%</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n2</span><span class="p">,</span><span class="n">p2</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Other voters       : </span><span class="si">%d</span><span class="s1"> (</span><span class="si">%05.2f%%</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n0</span><span class="p">,</span><span class="n">p0</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---------------- random polls ---------------&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Party_1(</span><span class="si">%04.1f%%</span><span class="s1">) | Party_2(</span><span class="si">%04.1f%%</span><span class="s1">)|   expected  &#39;</span><span class="o">%</span>\
                   <span class="p">(</span><span class="n">p1</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">p2</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span> <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----------------------------------------------&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  </span><span class="si">%s</span><span class="s2"> : </span><span class="si">%05.2f%%</span><span class="s2">  |  </span><span class="si">%s</span><span class="s2"> : </span><span class="si">%05.2f%%</span><span class="s2">  |  </span><span class="si">%s</span><span class="s2"> : </span><span class="si">%05.2f%%</span><span class="s2">&quot;</span> <span class="o">%</span>\
                  <span class="p">(</span><span class="n">poll1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">poll1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">100.0</span><span class="p">,</span>
                   <span class="n">poll2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">poll2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">100.0</span><span class="p">,</span>
                    <span class="n">poll</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">poll</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">100.0</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No polls defined !&#39;</span><span class="p">)</span></div></div>
        
<div class="viewcode-block" id="RandomVotingProfile"><a class="viewcode-back" href="../techDoc.html#votingProfiles.RandomVotingProfile">[docs]</a><span class="k">class</span> <span class="nc">RandomVotingProfile</span><span class="p">(</span><span class="n">VotingProfile</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A subclass for generating random voting profiles.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">numberOfVoters</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">numberOfCandidates</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>\
                 <span class="n">hasRandomWeights</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">maxWeight</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Random profile creation parameters:</span>

<span class="sd">            | numberOfVoters=9,</span>
<span class="sd">            | numberOfCandidates=5</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">votersList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">numberOfVoters</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">votersList</span><span class="p">:</span>
            <span class="n">voterID</span> <span class="o">=</span> <span class="s1">&#39;v</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">v</span>
            <span class="k">if</span> <span class="n">hasRandomWeights</span><span class="p">:</span>
                <span class="n">voters</span><span class="p">[</span><span class="n">voterID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">maxWeight</span><span class="p">)}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">voters</span><span class="p">[</span><span class="n">voterID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
        <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">numberOfCandidates</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidatesList</span><span class="p">:</span>
            <span class="n">candidateID</span> <span class="o">=</span> <span class="s1">&#39;a</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span>
            <span class="n">candidates</span><span class="p">[</span><span class="n">candidateID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">candidateID</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;randAVProfile&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="n">candidates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">voters</span> <span class="o">=</span> <span class="n">voters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generateRandomBallot</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showAll</span><span class="p">()</span>

<div class="viewcode-block" id="RandomVotingProfile.generateRandomBallot"><a class="viewcode-back" href="../techDoc.html#votingProfiles.RandomVotingProfile.generateRandomBallot">[docs]</a>    <span class="k">def</span> <span class="nf">generateRandomBallot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">seed</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a randomly generated approval ballot</span>
<span class="sd">        from a shuffled list of candidates for each voter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="k">if</span> <span class="n">seed</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">ballot</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">]</span>
        <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
                <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">candidatesList</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
                    <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">candidatesList</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">candidatesList</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">candidatesList</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
                    <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">candidatesList</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">candidatesList</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span>
                    <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">candidatesList</span><span class="p">[</span><span class="n">j</span><span class="p">]][</span><span class="n">candidatesList</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
        <span class="k">return</span> <span class="n">ballot</span></div></div>

<span class="c1">#--------------------------------</span>
<div class="viewcode-block" id="CondorcetDigraph"><a class="viewcode-back" href="../techDoc.html#votingProfiles.CondorcetDigraph">[docs]</a><span class="k">class</span> <span class="nc">CondorcetDigraph</span><span class="p">(</span><span class="n">Digraph</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialization of the general Digraph class for generating</span>
<span class="sd">    bipolar-valued marginal pairwise majority difference digraphs.</span>

<span class="sd">    Parameters:</span>

<span class="sd">        | stored voting profile (fileName of valid py code) or voting profile object</span>
<span class="sd">        | optional, coalition (sublist of voters)</span>

<span class="sd">    Example Python3 session</span>

<span class="sd">    &gt;&gt;&gt; from votingDigraphs import *</span>
<span class="sd">    &gt;&gt;&gt; v = RandomLinearVotingProfile(numberOfVoters=101,numberOfCandidates=5)</span>
<span class="sd">    &gt;&gt;&gt; v.showLinearBallots()</span>
<span class="sd">    v101(1.0): 	 [&#39;a5&#39;, &#39;a1&#39;, &#39;a2&#39;, &#39;a4&#39;, &#39;a3&#39;]</span>
<span class="sd">    v100(1.0): 	 [&#39;a4&#39;, &#39;a1&#39;, &#39;a5&#39;, &#39;a3&#39;, &#39;a2&#39;]</span>
<span class="sd">    v89(1.0): 	 [&#39;a4&#39;, &#39;a5&#39;, &#39;a1&#39;, &#39;a2&#39;, &#39;a3&#39;]</span>
<span class="sd">    v88(1.0): 	 [&#39;a3&#39;, &#39;a2&#39;, &#39;a5&#39;, &#39;a1&#39;, &#39;a4&#39;]</span>
<span class="sd">    v87(1.0): 	 [&#39;a5&#39;, &#39;a2&#39;, &#39;a4&#39;, &#39;a3&#39;, &#39;a1&#39;]</span>
<span class="sd">    v86(1.0): 	 [&#39;a5&#39;, &#39;a3&#39;, &#39;a1&#39;, &#39;a4&#39;, &#39;a2&#39;]</span>
<span class="sd">    v85(1.0): 	 [&#39;a5&#39;, &#39;a3&#39;, &#39;a2&#39;, &#39;a4&#39;, &#39;a1&#39;]</span>
<span class="sd">    v84(1.0): 	 [&#39;a3&#39;, &#39;a1&#39;, &#39;a2&#39;, &#39;a4&#39;, &#39;a5&#39;]</span>
<span class="sd">    ...</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; g = CondorcetDigraph(v,hasIntegerValuation=True)</span>
<span class="sd">    &gt;&gt;&gt; g.showRelationTable()</span>
<span class="sd">    * ---- Relation Table -----</span>
<span class="sd">     S   |  &#39;a1&#39;  &#39;a2&#39;	 &#39;a3&#39;	&#39;a4&#39;  &#39;a5&#39;	  </span>
<span class="sd">    -----|------------------------------------------------------------</span>
<span class="sd">    &#39;a1&#39; |   -	   33	  9	 11    21	 </span>
<span class="sd">    &#39;a2&#39; |  -33	   -	 -19	 -1    -5	 </span>
<span class="sd">    &#39;a3&#39; |  -9	   19	 -	 5     -1	 </span>
<span class="sd">    &#39;a4&#39; |  -11	   1	  -5	 -     -9	 </span>
<span class="sd">    &#39;a5&#39; |  -21	   5	   1	 9      -</span>
<span class="sd">    &gt;&gt;&gt; g.computeCondorcetWinner()</span>
<span class="sd">    [&#39;a1&#39;]</span>
<span class="sd">    &gt;&gt;&gt; g.exportGraphViz()</span>
<span class="sd">    *---- exporting a dot file dor GraphViz tools ---------*</span>
<span class="sd">    Exporting to rel_randLinearProfile.dot</span>
<span class="sd">    dot -Grankdir=BT -Tpng rel_randLinearProfile.dot -o rel_randLinearProfile.png</span>

<span class="sd">    .. image:: rel_randLinearProfile.png</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">argVotingProfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>\
                 <span class="n">approvalVoting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">coalition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>\
                 <span class="n">majorityMargins</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">hasIntegerValuation</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argVotingProfile</span><span class="p">,</span> <span class="p">(</span><span class="n">VotingProfile</span><span class="p">,</span><span class="n">ApprovalVotingProfile</span><span class="p">)):</span>
            <span class="n">votingProfile</span> <span class="o">=</span> <span class="n">argVotingProfile</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">argVotingProfile</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">votingProfile</span> <span class="o">=</span> <span class="n">VotingProfile</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">approvalVoting</span><span class="p">:</span>
                <span class="n">votingProfile</span> <span class="o">=</span> <span class="n">ApprovalVotingProfile</span><span class="p">(</span><span class="n">argVotingProfile</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">votingProfile</span> <span class="o">=</span> <span class="n">VotingProfile</span><span class="p">(</span><span class="n">argVotingProfile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;rel_&#39;</span> <span class="o">+</span> <span class="n">votingProfile</span><span class="o">.</span><span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">votingProfile</span><span class="o">.</span><span class="n">candidates</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">coalition</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">voters</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">votingProfile</span><span class="o">.</span><span class="n">voters</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">voters</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">coalition</span><span class="p">:</span>
                <span class="n">voters</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">votingProfile</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">voters</span> <span class="o">=</span> <span class="n">voters</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">votingProfile</span><span class="p">,</span> <span class="p">(</span><span class="n">VotingProfile</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">votingProfile</span><span class="o">.</span><span class="n">ballot</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constructBallotRelation</span><span class="p">(</span><span class="n">hasIntegerValuation</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">votingProfile</span><span class="p">,</span> <span class="p">(</span><span class="n">ApprovalVotingProfile</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">votingProfile</span><span class="o">.</span><span class="n">approvalBallot</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">majorityMargins</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constructMajorityMarginsRelation</span><span class="p">(</span><span class="n">hasIntegerValuation</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constructApprovalBallotRelation</span><span class="p">(</span><span class="n">hasIntegerValuation</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1">#self.valuationdomain = {&#39;min&#39;:Decimal(&#39;-1.0&#39;),&#39;med&#39;:Decimal(&#39;0.0&#39;),&#39;max&#39;:Decimal(&#39;1.0&#39;)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>


<div class="viewcode-block" id="CondorcetDigraph.constructApprovalBallotRelation"><a class="viewcode-back" href="../techDoc.html#votingProfiles.CondorcetDigraph.constructApprovalBallotRelation">[docs]</a>    <span class="k">def</span> <span class="nf">constructApprovalBallotRelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">hasIntegerValuation</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the votes differences between candidates</span>
<span class="sd">        on the basis of an approval ballot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
        <span class="n">sumWeight</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="n">sumWeight</span> <span class="o">+=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">hasIntegerValuation</span><span class="p">:</span>
            <span class="n">Min</span> <span class="o">=</span> <span class="o">-</span><span class="n">sumWeight</span>
            <span class="n">Max</span> <span class="o">=</span> <span class="n">sumWeight</span>
            <span class="n">Med</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1.0&#39;</span><span class="p">)</span>
            <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">)</span>
            <span class="n">Med</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">Min</span><span class="p">,</span> <span class="s1">&#39;med&#39;</span><span class="p">:</span> <span class="n">Med</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">Max</span><span class="p">,</span> <span class="s1">&#39;hasIntegerValuation&#39;</span><span class="p">:</span> <span class="n">hasIntegerValuation</span><span class="p">}</span>
        <span class="n">approvalBallot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">approvalBallot</span><span class="p">:</span>
            <span class="n">voted</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">approvalBallot</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
            <span class="n">non_voted</span> <span class="o">=</span> <span class="n">actions</span> <span class="o">-</span> <span class="n">voted</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">voted</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">non_voted</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">+=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]))</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">+=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">hasIntegerValuation</span> <span class="ow">and</span> <span class="n">Max</span> <span class="o">!=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">):</span>
                        <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">/=</span> <span class="n">Max</span>

        <span class="k">return</span> <span class="n">relation</span></div>

<div class="viewcode-block" id="CondorcetDigraph.constructMajorityMarginsRelation"><a class="viewcode-back" href="../techDoc.html#votingProfiles.CondorcetDigraph.constructMajorityMarginsRelation">[docs]</a>    <span class="k">def</span> <span class="nf">constructMajorityMarginsRelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">hasIntegerValuation</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the marginal majority between candidates</span>
<span class="sd">        on the basis of an approval ballot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
        <span class="n">sumWeight</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="n">sumWeight</span> <span class="o">+=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">hasIntegerValuation</span><span class="p">:</span>
            <span class="n">Min</span> <span class="o">=</span> <span class="o">-</span><span class="n">sumWeight</span>
            <span class="n">Max</span> <span class="o">=</span> <span class="n">sumWeight</span>
            <span class="n">Med</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1.0&#39;</span><span class="p">)</span>
            <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">)</span>
            <span class="n">Med</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">Min</span><span class="p">,</span> <span class="s1">&#39;med&#39;</span><span class="p">:</span> <span class="n">Med</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">Max</span><span class="p">,</span> <span class="s1">&#39;hasIntegerValuation&#39;</span><span class="p">:</span> <span class="n">hasIntegerValuation</span><span class="p">}</span>
        <span class="n">approvalBallot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">approvalBallot</span><span class="p">:</span>
            <span class="n">voted</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">approvalBallot</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
            <span class="n">non_voted</span> <span class="o">=</span> <span class="n">actions</span> <span class="o">-</span> <span class="n">voted</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">voted</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">voted</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">+=</span> <span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">non_voted</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">+=</span> <span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">non_voted</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">voted</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">non_voted</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">+=</span> <span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">hasIntegerValuation</span> <span class="ow">and</span> <span class="n">Max</span> <span class="o">!=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">):</span>
                        <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">/=</span> <span class="n">Max</span>
        <span class="k">return</span> <span class="n">relation</span></div>

<div class="viewcode-block" id="CondorcetDigraph.showMajorityMargins"><a class="viewcode-back" href="../techDoc.html#votingProfiles.CondorcetDigraph.showMajorityMargins">[docs]</a>    <span class="k">def</span> <span class="nf">showMajorityMargins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Wrapper for the</span>
<span class="sd">        Digraph.showRelationTable(Sorted=True, IntegerValues=False,</span>
<span class="sd">        actionsSubset=None, relation=None, ndigits=2,</span>
<span class="sd">        ReflexiveTerms=True)</span>

<span class="sd">        See the :py:meth:`digraphs.Digraph.showRelationTable` description.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Digraph</span><span class="o">.</span><span class="n">showRelationTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">args</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="CondorcetDigraph.computeCondorcetWinner"><a class="viewcode-back" href="../techDoc.html#votingProfiles.CondorcetDigraph.computeCondorcetWinner">[docs]</a>    <span class="k">def</span> <span class="nf">computeCondorcetWinner</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        compute the Condorcet winner(s)</span>
<span class="sd">        renders always a, potentially empty, list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span>
        <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="n">condorcetWinners</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidatesList</span><span class="p">:</span>
            <span class="n">Winner</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">candidatesList</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span> <span class="ow">and</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">Winner</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">Winner</span><span class="p">:</span>
                <span class="n">condorcetWinners</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">condorcetWinners</span></div>


<div class="viewcode-block" id="CondorcetDigraph.constructBallotRelation"><a class="viewcode-back" href="../techDoc.html#votingProfiles.CondorcetDigraph.constructBallotRelation">[docs]</a>    <span class="k">def</span> <span class="nf">constructBallotRelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">hasIntegerValuation</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the marginal majority between candidates</span>
<span class="sd">        on the basis of a complete ballot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
        <span class="n">ballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span>
        <span class="n">sumWeight</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="n">sumWeight</span> <span class="o">+=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">hasIntegerValuation</span><span class="p">:</span>
            <span class="n">Min</span> <span class="o">=</span> <span class="o">-</span><span class="n">sumWeight</span>
            <span class="n">Max</span> <span class="o">=</span> <span class="n">sumWeight</span>
            <span class="n">Med</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1.0&#39;</span><span class="p">)</span>
            <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">)</span>
            <span class="n">Med</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">Min</span><span class="p">,</span> <span class="s1">&#39;med&#39;</span><span class="p">:</span> <span class="n">Med</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">Max</span><span class="p">,</span> <span class="s1">&#39;hasIntegerValuation&#39;</span><span class="p">:</span> <span class="n">hasIntegerValuation</span><span class="p">}</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">voters</span><span class="p">)</span>
                <span class="n">counter</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
                    <span class="n">counter</span> <span class="o">+=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]))</span><span class="o">*</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]))</span>
                <span class="k">if</span> <span class="n">hasIntegerValuation</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">counter</span>
                <span class="k">elif</span> <span class="n">sumWeight</span> <span class="o">!=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">):</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">counter</span><span class="o">/</span><span class="n">sumWeight</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
        <span class="k">return</span> <span class="n">relation</span></div>

<div class="viewcode-block" id="CondorcetDigraph.computeCopelandRanking"><a class="viewcode-back" href="../techDoc.html#votingProfiles.CondorcetDigraph.computeCopelandRanking">[docs]</a>    <span class="k">def</span> <span class="nf">computeCopelandRanking</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a ranking of the actions following Copeland&#39;s rule.</span>
<span class="sd">        Score(x_i) = Sum_j{ [[x_i &gt; x_j]] - [[x_j &gt; x_i]]}, where</span>
<span class="sd">        [[x &gt; y]] = 1 if x&gt;y is true, otherwise 0.</span>

<span class="sd">        The alternatives are ranked in decreasing order of their Scores.</span>

<span class="sd">        In case of a tie, we use a lexicographic rule applied to the identifiers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">scores</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">scores</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">scores</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">relation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">scores</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">relation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">scores</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">scoresRanking</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">scores</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">]</span>
        <span class="n">scoresRanking</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">scoresRanking</span><span class="p">,</span><span class="n">key</span> <span class="o">=</span> <span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ranking</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">scoresRanking</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">scoresRanking</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ranking</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ranking</span></div>

<div class="viewcode-block" id="CondorcetDigraph.computeNetFlowsRanking"><a class="viewcode-back" href="../techDoc.html#votingProfiles.CondorcetDigraph.computeNetFlowsRanking">[docs]</a>    <span class="k">def</span> <span class="nf">computeNetFlowsRanking</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a ranking of the actions following the Net Flows rule.</span>
<span class="sd">        Score(x_i) = Sum_j{M(x_i,x_j)} for i,j = 1..n</span>

<span class="sd">        The alternatives are ranked in decreasing order of their Scores.</span>

<span class="sd">        In case of a tie, we use a lexicographic rule applied to the identifiers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">scores</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="n">scores</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">-</span> <span class="n">relation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
        <span class="n">scoresRanking</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">scores</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">]</span>
        <span class="n">scoresRanking</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">scoresRanking</span><span class="p">,</span><span class="n">key</span> <span class="o">=</span> <span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ranking</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">scoresRanking</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">scoresRanking</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ranking</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ranking</span></div>

<div class="viewcode-block" id="CondorcetDigraph.computeKohlerRanking"><a class="viewcode-back" href="../techDoc.html#votingProfiles.CondorcetDigraph.computeKohlerRanking">[docs]</a>    <span class="k">def</span> <span class="nf">computeKohlerRanking</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">linearOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a ranking of the actions following Kohler&#39;s rule.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">actionsList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span>
        <span class="n">rank</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="n">actionsList</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="n">maximin</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
                <span class="n">xmin</span> <span class="o">=</span> <span class="n">Max</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">xmin</span><span class="p">:</span>
                            <span class="n">xmin</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x, xmin&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">xmin</span><span class="p">)</span>
                <span class="n">maximin</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">xmin</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>
            <span class="n">maximin</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">maximin</span><span class="p">,</span> <span class="n">maximin</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">rank</span><span class="p">[</span><span class="n">maximin</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rank&#39;</span><span class="p">:</span><span class="n">k</span><span class="p">,</span><span class="s1">&#39;majorityMargin&#39;</span><span class="p">:</span><span class="n">maximin</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]}</span>
            <span class="n">actionsList</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">maximin</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;actionsList&#39;</span><span class="p">,</span> <span class="n">actionsList</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">rank</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rank</span></div>

<div class="viewcode-block" id="CondorcetDigraph.computeArrowRaynaudRanking"><a class="viewcode-back" href="../techDoc.html#votingProfiles.CondorcetDigraph.computeArrowRaynaudRanking">[docs]</a>    <span class="k">def</span> <span class="nf">computeArrowRaynaudRanking</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">linearOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a ranking of the actions following Arrow&amp;Raynaud&#39;s rule.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">actionsList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span>
        <span class="n">rank</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="n">actionsList</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="n">minimax</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
                <span class="n">xmax</span> <span class="o">=</span> <span class="n">Min</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">xmax</span><span class="p">:</span>
                            <span class="n">xmax</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x, xmax&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
                <span class="n">minimax</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">xmax</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>
            <span class="n">minimax</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">minimax</span><span class="p">,</span> <span class="n">minimax</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">rank</span><span class="p">[</span><span class="n">minimax</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rank&#39;</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;majorityMargin&#39;</span><span class="p">:</span><span class="n">minimax</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]}</span>
            <span class="n">actionsList</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">minimax</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;actionsList&#39;</span><span class="p">,</span> <span class="n">actionsList</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">rank</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rank</span></div>

<div class="viewcode-block" id="CondorcetDigraph.showRankingByChoosing"><a class="viewcode-back" href="../techDoc.html#votingProfiles.CondorcetDigraph.showRankingByChoosing">[docs]</a>    <span class="k">def</span> <span class="nf">showRankingByChoosing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">rankingByChoosing</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A specialized show method for self.rankinByChoosing result from CondorcetDigraphs.</span>

<span class="sd">        The bracketed numbers  following the reiterated *first* and *last* choices,</span>
<span class="sd">        indicate the average majority margin with which the *i*-th *first* choice,</span>
<span class="sd">        respectively the *i*-th *last* choice, is beating, resp. is beaten by,</span>
<span class="sd">        the remaining candidates at step *i*.</span>

<span class="sd">        .. warning::</span>

<span class="sd">           The self.computeRankingByChoosing(CoDual=False/True) method instantiating</span>
<span class="sd">           the self.rankingByChoosing slot is pre-required !</span>
<span class="sd">             </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">rankingByChoosing</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rankingByChoosing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rankingByChoosing</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: You must first run self.computeRankingByChoosing(CoDual=False(default)|True) !&#39;</span><span class="p">)</span>
            <span class="c1">#rankingByChoosing = self.computeRankingByChoosing(Debug,CoDual)</span>
                <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rankingByChoosing</span> <span class="o">=</span> <span class="n">rankingByChoosing</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ranking by Choosing and Rejecting&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------&#39;</span><span class="p">)</span>
        <span class="n">space</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rankingByChoosing</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">nstr</span><span class="o">=</span><span class="s1">&#39;st&#39;</span>
            <span class="k">elif</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">nstr</span><span class="o">=</span><span class="s1">&#39;nd&#39;</span>
            <span class="k">elif</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">nstr</span><span class="o">=</span><span class="s1">&#39;rd&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nstr</span><span class="o">=</span><span class="s1">&#39;th&#39;</span>
            <span class="n">ibch</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">iwch</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">iach</span> <span class="o">=</span> <span class="n">iwch</span> <span class="o">&amp;</span> <span class="n">ibch</span>
            <span class="c1">#print &#39;ibch, iwch, iach&#39;, i, ibch,iwch,iach</span>
            <span class="n">ch</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ibch</span><span class="p">)</span>
            <span class="n">ch</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s%s%s</span><span class="s1"> first ranked: </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">space</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nstr</span><span class="p">,</span><span class="n">ch</span><span class="p">,</span><span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">iach</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%s</span><span class="s1"> Ambiguous ranking </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">space</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">iach</span><span class="p">)))</span>
                <span class="n">space</span> <span class="o">+=</span> <span class="s1">&#39;  &#39;</span>
            <span class="n">space</span> <span class="o">+=</span> <span class="s1">&#39;  &#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">n</span><span class="o">-</span><span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">nstr</span><span class="o">=</span><span class="s1">&#39;st&#39;</span>
            <span class="k">elif</span> <span class="n">n</span><span class="o">-</span><span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">nstr</span><span class="o">=</span><span class="s1">&#39;nd&#39;</span>
            <span class="k">elif</span> <span class="n">n</span><span class="o">-</span><span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">nstr</span><span class="o">=</span><span class="s1">&#39;rd&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nstr</span><span class="o">=</span><span class="s1">&#39;th&#39;</span>
            <span class="n">space</span> <span class="o">=</span> <span class="n">space</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">ibch</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">iwch</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">iach</span> <span class="o">=</span> <span class="n">iwch</span> <span class="o">&amp;</span> <span class="n">ibch</span>
            <span class="c1">#print &#39;ibch, iwch, iach&#39;, i, ibch,iwch,iach</span>
            <span class="n">ch</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">iwch</span><span class="p">)</span>
            <span class="n">ch</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">iach</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">space</span> <span class="o">=</span> <span class="n">space</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%s</span><span class="s1"> Ambiguous ranking </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">space</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">iach</span><span class="p">)))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s%s%s</span><span class="s1"> last ranked: </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">space</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="n">nstr</span><span class="p">,</span><span class="n">ch</span><span class="p">,</span><span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span></div></div>

<span class="c1">#----------test voting Digraph class ----------------</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">transitiveDigraphs</span> <span class="kn">import</span> <span class="o">*</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;****************************************************&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* Python voting digraphs module                    *&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* $Revision: 2484 $                                   *&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* Copyright (C) 2006-2007 University of Luxembourg *&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* The module comes with ABSOLUTELY NO WARRANTY     *&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* to the extent permitted by the applicable law.   *&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* This is free software, and you are welcome to    *&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* redistribute it if it remains free software.     *&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;****************************************************&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*-------- Testing classes and methods -------&#39;</span><span class="p">)</span>

    <span class="c1">## v = RandomVotingProfile(hasRandomWeights=True,maxWeight=4,Debug=True)</span>
    <span class="c1">## v.save(&#39;testprofile&#39;)</span>
    <span class="c1">## v.showAll()</span>
    <span class="c1">## c = CondorcetDigraph(v)</span>
    <span class="c1">## c.save(&#39;testcondorcet&#39;)</span>
    <span class="c1">## c.showRelationTable()</span>
    <span class="c1">## kr = c.computeKohlerRanking(Debug=False)</span>
    <span class="c1">## kohlerRanking = [(kr[x][&#39;rank&#39;],x) for x in kr]</span>
    <span class="c1">## kohlerRanking.sort()</span>
    <span class="c1">## for x in kohlerRanking:</span>
    <span class="c1">##     print &#39;%s: %d (%.2f)&#39; % (x[1], x[0], kr[x[1]][&#39;majorityMargin&#39;])</span>
    <span class="c1">## aar = c.computeArrowRaynaudRanking(Debug=True)</span>
    <span class="c1">## arrowRaynaudRanking = [(aar[x][&#39;rank&#39;],x) for x in aar]</span>
    <span class="c1">## arrowRaynaudRanking.sort()</span>
    <span class="c1">## for x in arrowRaynaudRanking:</span>
    <span class="c1">##     print &#39;%s: %d (%.2f)&#39; % (x[1], x[0], aar[x[1]][&#39;majorityMargin&#39;])</span>

    <span class="n">lvp</span> <span class="o">=</span> <span class="n">RandomLinearVotingProfile</span><span class="p">(</span><span class="n">numberOfCandidates</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                            <span class="n">numberOfVoters</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                            <span class="n">WithPolls</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">partyRepartition</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                            <span class="n">other</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                            <span class="c1">#seed=0.20990710811162194) # 1 circuit</span>
                            <span class="c1">#seed=0.8077233289616987)  # 2 circuits !</span>
                            <span class="n">seed</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="c1">##    ## lvp = LinearVotingProfile(&#39;templinearprofile&#39;)</span>
<span class="c1">##    lvp.save()</span>
<span class="c1">##    lvp1 = LinearVotingProfile(&#39;templinearprofile&#39;)</span>
<span class="c1">##    lvp1 = LinearVotingProfile(&#39;example1&#39;)</span>
<span class="c1">##    lvp1.computeBallot()</span>
<span class="c1">##    ## for x in lvp.voters:</span>
<span class="c1">##    ##    print x, lvp.linearBallot[x]</span>
<span class="c1">##    lvp1.showLinearBallots(IntegerWeights=True)</span>
<span class="c1">##    lvp1.showVoterBallot(&#39;v001&#39;)</span>
<span class="c1">####    print(lvp.computeRankAnalysis())</span>
<span class="c1">##    lvp1.computeInstantRunoffWinner()</span>
<span class="c1">##    lvp1.showRankAnalysisTable(Debug=False)</span>
<span class="c1">##    lvp1.showBordaRanking()</span>
<span class="c1">##    lvp1.computeBordaWinners()</span>
<span class="c1">##    lvp1.save2PerfTab(&#39;votingPerfTab&#39;)</span>
<span class="c1">##    t = PerformanceTableau(&#39;votingPerfTab&#39;)</span>
<span class="c1">##    #t.showHTMLPerformanceHeatmap(Transposed=True,Correlations=True,ndigits=0)</span>
<span class="c1">##    #lvp.showHTMLVotingHeatmap(Correlations=True)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">CondorcetDigraph</span><span class="p">(</span><span class="n">lvp</span><span class="p">)</span>
    <span class="c1">#c.recodeValuation()</span>
    <span class="n">c</span><span class="o">.</span><span class="n">showRelationTable</span><span class="p">()</span>
<span class="c1">##    (~(-c)).showRelationTable()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">computeCopelandRanking</span><span class="p">(</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">computeNetFlowsRanking</span><span class="p">(</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="n">lvp</span><span class="o">.</span><span class="n">showRandomPolls</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">computeTransitivityDegree</span><span class="p">())</span>
    <span class="n">c</span><span class="o">.</span><span class="n">computeChordlessCircuits</span><span class="p">()</span>
    <span class="n">c</span><span class="o">.</span><span class="n">showChordlessCircuits</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">chordlessCircuits</span> <span class="o">!=</span> <span class="p">[]:</span>
        <span class="c1">#MP = True</span>
        <span class="n">c</span><span class="o">.</span><span class="n">recodeValuation</span><span class="p">()</span>
        <span class="n">wc</span> <span class="o">=</span> <span class="n">WeakCopelandOrder</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Weak Copeland ranking&#39;</span><span class="p">)</span>
        <span class="n">wc</span><span class="o">.</span><span class="n">showRankingByChoosing</span><span class="p">()</span>
        <span class="n">corr</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">computeRankingCorrelation</span><span class="p">(</span><span class="n">wc</span><span class="o">.</span><span class="n">copelandRanking</span><span class="p">)</span>
        <span class="n">wc</span><span class="o">.</span><span class="n">showCorrelation</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>
        <span class="n">wn</span> <span class="o">=</span> <span class="n">WeakNetFlowsOrder</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Weak NetFlows ranking&#39;</span><span class="p">)</span>
        <span class="n">wn</span><span class="o">.</span><span class="n">showRankingByChoosing</span><span class="p">()</span>
        <span class="n">corr</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">computeRankingCorrelation</span><span class="p">(</span><span class="n">wn</span><span class="o">.</span><span class="n">netFlowsRanking</span><span class="p">)</span>
        <span class="n">wn</span><span class="o">.</span><span class="n">showCorrelation</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>
        <span class="n">lvp</span><span class="o">.</span><span class="n">showRandomPolls</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">lvp</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>

<span class="c1">##    from linearOrders import NetFlowsOrder</span>
<span class="c1">##    nf = NetFlowsOrder(c,Debug=True)</span>
<span class="c1">##    from outrankingDigraphs import *</span>
<span class="c1">##    t1 = RandomCBPerformanceTableau(numberOfActions=5)</span>
<span class="c1">##    g1 = BipolarOutrankingDigraph(t1)</span>
<span class="c1">##    g1.showRelationTable()</span>
<span class="c1">##    nf1 = NetFlowsOrder(g1,Debug=True)</span>
    
    
<span class="c1">##    lvp1.showHTMLVotingHeatmap()</span>
<span class="c1">##    </span>
<span class="c1">##    print(lvp.computeBordaWinners())</span>
<span class="c1">##    print(lvp.computeUninominalVotes(lvp.candidates,lvp.linearBallot))</span>
<span class="c1">##    print(lvp.computeInstantRunoffWinner(Comments=True))</span>
<span class="c1">##    print(lvp.computeSimpleMajorityWinner(Comments=True))</span>
<span class="c1">##</span>
<span class="c1">##    c = CondorcetDigraph(lvp)</span>
<span class="c1">##    c.exportGraphViz()</span>
<span class="c1">##    print(&#39;Chordless circuits = &#39;, c.computeChordlessCircuits())</span>
<span class="c1">##    print(&#39;Condorcet Winner = &#39;, c.computeCondorcetWinner())</span>
<span class="c1">##    m = len(lvp.voters)</span>
<span class="c1">##    c.recodeValuation(-m,m)</span>
<span class="c1">##    c.showRelationTable()</span>

<span class="c1">##    av = ApprovalVotingProfile(&#39;approvalInvitation&#39;)</span>
<span class="c1">##    av.save2PerfTab()</span>
<span class="c1">##    t = PerformanceTableau(&#39;votingPerfTab&#39;)</span>
<span class="c1">##    t.showHTMLPerformanceHeatmap(Correlations=True,ndigits=0)</span>
    
    

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*------------------*&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;If you see this line all tests were passed successfully :-)&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Enjoy !&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*************************************&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* R.B. September 2008               *&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* $Revision: 2484 $                   *&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*************************************&#39;</span><span class="p">)</span>

<span class="c1">#############################</span>
<span class="c1"># Log record for changes:</span>
<span class="c1"># $Log: votingDigraphs.py,v $#</span>
<span class="c1">#############################</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Digraph3 3.7-3200+ documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2012-2020, Raymond Bisdorff.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.3.0.
    </div>
  </body>
</html>